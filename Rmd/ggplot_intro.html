<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Matt O’Donnell" />


<title>Intro to ggplot2</title>

<script src="ggplot_intro_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="ggplot_intro_files/bootstrap-3.3.1/css/united.min.css" rel="stylesheet" />
<script src="ggplot_intro_files/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="ggplot_intro_files/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="ggplot_intro_files/bootstrap-3.3.1/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="ggplot_intro_files/highlight/default.css"
      type="text/css" />
<script src="ggplot_intro_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">


<div id="header">
<h1 class="title">Intro to ggplot2</h1>
<h4 class="author"><em>Matt O’Donnell</em></h4>
<h4 class="date"><em>February 5, 2016</em></h4>
</div>

<div id="TOC">
<ul>
<li><a href="#ggplot2---the-grammar-of-graphics"><span class="toc-section-number">0.1</span> ggplot2 - The Grammar of Graphics</a><ul>
<li><a href="#this-is-a-wide-data-frame"><span class="toc-section-number">0.1.0.1</span> This is a <strong>wide</strong> data frame</a></li>
</ul></li>
<li><a href="#simple-example-scatter-plot"><span class="toc-section-number">0.2</span> Simple Example: Scatter plot</a></li>
<li><a href="#the-components-of-a-ggplot"><span class="toc-section-number">0.3</span> The components of a ggplot</a><ul>
<li><a href="#ggplot-function"><span class="toc-section-number">0.3.1</span> <code>ggplot()</code> function</a></li>
<li><a href="#a-geom-function"><span class="toc-section-number">0.3.2</span> A <strong>geom</strong> function</a><ul>
<li><a href="#a-scatter-plot-of-var1-x-against-var2-y"><span class="toc-section-number">0.3.2.1</span> A scatter plot of var1 (x) against var2 (y)</a></li>
<li><a href="#a-line-plot-connecting-xy-points"><span class="toc-section-number">0.3.2.2</span> A line plot connecting x,y points</a></li>
<li><a href="#a-path-line-plot-connecting-xy-points-in-order"><span class="toc-section-number">0.3.2.3</span> A path line plot connecting x,y points in order</a></li>
<li><a href="#a-bar-graph-counting-the-number-of-items-in-each-group-var4"><span class="toc-section-number">0.3.2.4</span> A bar graph counting the number of items in each group (var4)</a></li>
<li><a href="#a-boxplot"><span class="toc-section-number">0.3.2.5</span> A boxplot</a></li>
</ul></li>
<li><a href="#graph-labels"><span class="toc-section-number">0.3.3</span> Graph labels</a></li>
<li><a href="#adding-additional-aesthetics"><span class="toc-section-number">0.3.4</span> Adding additional aesthetics</a></li>
<li><a href="#adding-lines-to-a-plot"><span class="toc-section-number">0.3.5</span> Adding lines to a plot</a></li>
</ul></li>
</ul>
</div>

<div id="ggplot2---the-grammar-of-graphics" class="section level2">
<h2><span class="header-section-number">0.1</span> ggplot2 - The Grammar of Graphics</h2>
<pre class="r"><code>library(ggplot2)</code></pre>
<p><strong>ggplot2</strong> is an implementation of the Grammar of Graphics theory and method of data visualization that builds up plots through layers and components. Data is mapped to particular aesthetics, i.e. which variable in your data set should be mpapped to which element of a plot (e.g. the X and Y axis or a grouping element, such as different lines, colored bars or panels).</p>
<p>Having your data in a data frame is the most natural and straight forward representation for using ggplot2.</p>
<div id="this-is-a-wide-data-frame" class="section level4">
<h4><span class="header-section-number">0.1.0.1</span> This is a <strong>wide</strong> data frame</h4>
<pre class="r"><code>df_wide &lt;- data.frame(
  id = paste(&#39;p&#39;, 1:5, sep=&#39;&#39;),
  var1 = sample(1:100, 5),
  var2 = sample(500:1000, 5),
  var3 = sample(1000:10000,5),
  var4 = c(&#39;A&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;C&#39;)
)

df_wide</code></pre>
<pre><code>##   id var1 var2 var3 var4
## 1 p1   13  554 3168    A
## 2 p2   10  596 7372    A
## 3 p3   31  513 3487    B
## 4 p4   73  818 6156    C
## 5 p5   85  502 8190    C</code></pre>
</div>
</div>
<div id="simple-example-scatter-plot" class="section level2">
<h2><span class="header-section-number">0.2</span> Simple Example: Scatter plot</h2>
<pre class="r"><code>ggplot(df_wide, aes(x=var1, y=var2)) + geom_point()</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-3-1.png" /></p>
</div>
<div id="the-components-of-a-ggplot" class="section level2">
<h2><span class="header-section-number">0.3</span> The components of a ggplot</h2>
<div id="ggplot-function" class="section level3">
<h3><span class="header-section-number">0.3.1</span> <code>ggplot()</code> function</h3>
<ul>
<li><code>ggplot()</code> is the main function required in every plot and is usually where you specify the data frame you are plotting and specify the mapping from data to plot element using the <code>aes</code> (aesthetics) function.</li>
</ul>
<p>You can build up the layers of a plot by assigning the result of the <code>ggplot</code> function to a variable and then adding layers. The following sets up the plot by specifying the data frame and the aesthetics, i.e. which variable should go to which axis in the plot. But it doesn’t plot anything.</p>
<pre class="r"><code>p &lt;- ggplot(df_wide, aes(x=var1, y=var2))</code></pre>
</div>
<div id="a-geom-function" class="section level3">
<h3><span class="header-section-number">0.3.2</span> A <strong>geom</strong> function</h3>
<p>Plots require a <strong>geom</strong> function to display the data. Examples include:</p>
<ul>
<li><code>geom_point()</code> - a scatter plot</li>
<li><code>geom_histogram()</code> - a histogram</li>
<li><code>geom_density()</code> - a density plot</li>
<li><code>geom_bar()</code> - a bar chart</li>
<li><code>geom_boxplot()</code> - a box plot</li>
<li><code>geom_line()</code> - a line plot</li>
<li><code>geom_path()</code> - a point to point path line plot (useful for geolocation data etc)</li>
<li><code>geom_text()</code> - a scatter plot with labels instead of points</li>
</ul>
<div id="a-scatter-plot-of-var1-x-against-var2-y" class="section level4">
<h4><span class="header-section-number">0.3.2.1</span> A scatter plot of var1 (x) against var2 (y)</h4>
<pre class="r"><code>p + geom_point()</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-5-1.png" /></p>
</div>
<div id="a-line-plot-connecting-xy-points" class="section level4">
<h4><span class="header-section-number">0.3.2.2</span> A line plot connecting x,y points</h4>
<pre class="r"><code>p + geom_line()</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-6-1.png" /></p>
</div>
<div id="a-path-line-plot-connecting-xy-points-in-order" class="section level4">
<h4><span class="header-section-number">0.3.2.3</span> A path line plot connecting x,y points in order</h4>
<pre class="r"><code>df_wide</code></pre>
<pre><code>##   id var1 var2 var3 var4
## 1 p1   13  554 3168    A
## 2 p2   10  596 7372    A
## 3 p3   31  513 3487    B
## 4 p4   73  818 6156    C
## 5 p5   85  502 8190    C</code></pre>
<pre class="r"><code>p + geom_path()</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-7-1.png" /></p>
<p>If we reorder the data frame the plot will look different.</p>
<pre class="r"><code>df2_wide2 &lt;- df_wide[order(df_wide$var1,df_wide$var2),]
p &lt;- ggplot(df2_wide2, aes(x=var1, y=var2))
p + geom_path()</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-8-1.png" /></p>
</div>
<div id="a-bar-graph-counting-the-number-of-items-in-each-group-var4" class="section level4">
<h4><span class="header-section-number">0.3.2.4</span> A bar graph counting the number of items in each group (var4)</h4>
<pre class="r"><code>p &lt;- ggplot(df_wide, aes(var4)) 
p + geom_bar()</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-9-1.png" /></p>
</div>
<div id="a-boxplot" class="section level4">
<h4><span class="header-section-number">0.3.2.5</span> A boxplot</h4>
<pre class="r"><code>p &lt;- ggplot(df_wide, aes(x=var4, y=var1)) 
p + geom_boxplot()</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-10-1.png" /></p>
<p>You can add aesthetic mappings to the <strong>geom</strong> function as well to control specific features of the the plot, e.g. the fill color of each boxplot or bar</p>
<pre class="r"><code>p + geom_boxplot(aes(fill=var4))</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-11-1.png" /></p>
<pre class="r"><code>p &lt;- ggplot(df_wide, aes(var4))
p + geom_bar(aes(fill=var4))</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-12-1.png" /></p>
</div>
</div>
<div id="graph-labels" class="section level3">
<h3><span class="header-section-number">0.3.3</span> Graph labels</h3>
<ul>
<li><code>xlab()</code> - specify label for x axis</li>
<li><code>ylab()</code> - specify label for y axis</li>
<li><code>ggtitle()</code> - specify title for graph and legends</li>
<li><code>labs()</code> - set all of the above with parameters in one function</li>
</ul>
<pre class="r"><code>p &lt;- ggplot(mtcars, aes(x=wt, y=mpg))
p + geom_point() +
  xlab(&#39;Miles per gallon&#39;) +
  ylab(&#39;Weight&#39;) +
  ggtitle(&#39;Car weight to fuel efficiency&#39;)</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-13-1.png" /></p>
<p>is equivalent to</p>
<pre class="r"><code>p + geom_point() + 
  labs(x=&#39;Miles per gallon&#39;, 
       y=&#39;Weight&#39;,
       title=&#39;Car weight to fuel efficiency&#39;)</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-14-1.png" /></p>
</div>
<div id="adding-additional-aesthetics" class="section level3">
<h3><span class="header-section-number">0.3.4</span> Adding additional aesthetics</h3>
<p>If you have more than two variables you want to represent you can make use of other graphic features such as:</p>
<ul>
<li>shape of points</li>
<li>color of points</li>
<li>size of points</li>
</ul>
<p>These can be added as aesthetics to the specific <strong>geom</strong> function, e.g. to <code>geom_point</code> for a scatter plot, by including a <code>aes</code> function</p>
<pre class="r"><code># 1. set up the main mapping from data to x and y axes
p &lt;- ggplot(mtcars, aes(x=mpg, y=wt))

# 2. set up a mapping with the color of points and the number of cylinders (needs to be treated as a factor not an numeric using factor())
p + geom_point(aes(colour=factor(cyl)))</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-15-1.png" /></p>
<pre class="r"><code># 3. add a fourth dimension for the displacement variable using point size
p + geom_point(aes(colour=factor(cyl), size=disp))</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-16-1.png" /></p>
<pre class="r"><code># 4. add in nicer labels for title, axes and legends

p + geom_point(aes(colour=factor(cyl), size=disp)) +
  ggtitle(&#39;Car relationship between weight and fuel efficency&#39;) +
  xlab(&#39;Car weight&#39;) +
  ylab(&#39;Miles per gallon&#39;) +
  ggtitle(aes(colour=&#39;Cylinders&#39;,
              size=&#39;Displacement&#39;))</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-17-1.png" /></p>
</div>
<div id="adding-lines-to-a-plot" class="section level3">
<h3><span class="header-section-number">0.3.5</span> Adding lines to a plot</h3>
<ul>
<li><code>geom_hline</code></li>
<li><code>geom_vline</code></li>
<li><code>geom_abline</code></li>
</ul>
<pre class="r"><code>ggplot(mtcars, aes(cyl,wt)) + stat_summary(fun.y=mean, geom=&#39;bar&#39;, aes(fill=factor(cyl))) + stat_summary(fun.data=mean_cl_boot, geom=&#39;errorbar&#39;, width=0.2)</code></pre>
<pre><code>## Warning: replacing previous import by &#39;ggplot2::unit&#39; when loading &#39;Hmisc&#39;</code></pre>
<pre><code>## Warning: replacing previous import by &#39;ggplot2::arrow&#39; when loading &#39;Hmisc&#39;</code></pre>
<pre><code>## Warning: replacing previous import by &#39;scales::alpha&#39; when loading &#39;Hmisc&#39;</code></pre>
<p><img src="ggplot_intro_files/figure-html/unnamed-chunk-18-1.png" /></p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
